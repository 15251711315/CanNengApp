(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/transientDetails/transientDetails"],{"06a4":function(module,exports,__webpack_require__){"use strict";(function(uni,__f__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var back=function(){return __webpack_require__.e("components/back").then(__webpack_require__.bind(null,"1898"))},_default={data:function(){return{pageNameFlag:1,showFlag:0,pageName:"暂态消息详情",radioFlag:0,eventDetailIndex:"",errorFlag:2,baseInfo:{},eigenvalueList:[],wave:{},sendAgain:"更新",second:60,sendAgainFlag:0,backNumber:0,eventMsgIndex:"",scrollHeight:"",loadingFlag:!1,disabledFlag:!1,judgeFlag:0,sagReason:"",transientName:"",sucessNum:0,baseFlag:0}},methods:{scrollH:function(){var e=this,t=uni.getSystemInfoSync(),a=t.windowWidth,n=750/a,s=t.windowHeight,i=t.statusBarHeight;e.scrollHeight=parseInt((s-i)*n-94)+"rpx"},changeRadioFlag:function(e){this.radioFlag=e},confirmJudge:function(e){var t=this,a="";0==uni.getStorageSync("userInfo").roleCode?(a=0==e?"确认对设备无影响？":"确认对设备有影响？",uni.showModal({title:"提示",content:a,success:function(a){if(a.confirm)t.judgeLogin()&&uni.request({url:t.serverUrl+"/eventmsg/eventDetailEvaluate",method:"POST",data:{eventDetailIndex:t.eventDetailIndex,evaluate:e,userId:uni.getStorageSync("userInfo").userId},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function(a){uni.hideLoading(),"10000"==a.data.resultCode?(uni.showModal({title:"提示",content:"评价更新成功",showCancel:!1}),t.judgeFlag=e):uni.showModal({title:"提示",content:"评价更新失败，请重试",confirmText:"重试",success:function(e){e.confirm?t.updateEvaluate():e.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:375")}})},fail:function(e){uni.showModal({title:"提示",content:"网络或服务器异常，请稍后再试",showCancel:!1,success:function(e){e.confirm?__f__("log","用户点击确定"," at pages\\transientDetails\\transientDetails.vue:388"):e.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:390")}})}});else if(a.cancel)return}})):uni.showModal({title:"提示",content:"您暂无评价权限",showCancel:!1})},eventDetailBaseInfo:function eventDetailBaseInfo(){var that=this;uni.request({url:that.serverUrl+"/eventmsg/eventDetailBaseInfo",method:"POST",data:{eventMsgIndex:that.eventMsgIndex},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function success(res){"10000"==res.data.resultCode?(that.baseInfo=eval(res.data.data),that.baseInfo.showTime=that.formatTime_mills(that.baseInfo.timeID),that.baseInfo.eventValue<100?that.transientName="暂降":that.transientName="暂升",that.judgeFlag=that.baseInfo.evaluate,that.sucessNum++,that.baseFlag=0,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag)):(that.sucessNum++,that.baseFlag=1,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag))},fail:function(e){that.sucessNum++,that.baseFlag=1,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag)}})},eventDetailEigenvalue:function eventDetailEigenvalue(){var that=this;uni.request({url:that.serverUrl+"/eventmsg/eventDetailEigenvalue",method:"POST",data:{eventDetailIndex:that.eventDetailIndex},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function success(res){"10000"==res.data.resultCode?(that.backNumber=res.data.backNumber,that.backNumber>0&&(that.sagReason=res.data.sagReason,that.eigenvalueList=eval(res.data.data)),that.sucessNum++,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag)):(that.backNumber=0,that.sucessNum++,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag))},fail:function(e){that.backNumber=0,that.sucessNum++,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag)}})},eventDetailWave:function eventDetailWave(){var that=this;uni.request({url:that.serverUrl+"/eventmsg/eventDetailWave",method:"POST",data:{eventDetailIndex:that.eventDetailIndex},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function success(res){"10000"==res.data.resultCode?(that.wave=eval(res.data.data),that.sucessNum++,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag)):(that.sucessNum++,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag))},fail:function(e){that.sucessNum++,3==that.sucessNum&&(uni.hideLoading(),that.errorFlag=that.baseFlag)}})},updateEvaluate:function(){var e=this;if(e.judgeLogin()){if(e.sendAgainFlag=1,uni.request({url:e.serverUrl+"/eventmsg/eventDetailEvaluate",method:"POST",data:{eventDetailIndex:e.eventDetailIndex,evaluate:e.radioFlag,userId:uni.getStorageSync("userInfo").userId},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function(t){uni.hideLoading(),"10000"==t.data.resultCode?uni.showModal({title:"提示",content:"评价更新成功",showCancel:!1}):uni.showModal({title:"提示",content:"评价更新失败，请重试",confirmText:"重试",success:function(t){t.confirm?e.updateEvaluate():t.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:564")}})},fail:function(e){uni.showModal({title:"提示",content:"网络或服务器异常，请稍后再试",showCancel:!1,success:function(e){e.confirm?__f__("log","用户点击确定"," at pages\\transientDetails\\transientDetails.vue:577"):e.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:579")}})}}),60!=e.second)return;e.second--;var t=setInterval(function(){e.sendAgain="更新("+e.second--+"S)"},1e3);setTimeout(function(){clearInterval(t),e.sendAgain="更新",e.second=60,e.sendAgainFlag=0},61e3)}},applyReport:function(){var e=this;e.judgeLogin()&&(e.disabledFlag=!0,e.loadingFlag=!0,uni.request({url:e.serverUrl+"/report/eventDetailReportApply",method:"POST",data:{eventDetailIndex:e.eventDetailIndex,userId:uni.getStorageSync("userInfo").userId},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function(t){e.loadingFlag=!1,e.disabledFlag=!1,"10000"==t.data.resultCode?(uni.showModal({title:"提示",content:"申请报告成功",showCancel:!1}),e.eventDetailBaseInfo()):uni.showModal({title:"提示",content:e.showError(t.data.msgCode,t.data.msg),confirmText:"重试",success:function(t){t.confirm?e.applyReport():t.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:635")}})},fail:function(t){e.loadingFlag=!1,e.disabledFlag=!1,uni.showModal({title:"提示",content:"网络或服务器异常，请稍后再试",showCancel:!1,success:function(e){e.confirm?__f__("log","用户点击确定"," at pages\\transientDetails\\transientDetails.vue:650"):e.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:652")}})}}))},downloadReport:function(){var e=this;e.judgeLogin()&&uni.request({url:e.serverUrl+"/report/eventDetailReportDownLoad",method:"POST",data:{eventDetailIndex:e.eventDetailIndex,userId:uni.getStorageSync("userInfo").userId},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function(t){uni.hideLoading(),"10000"==t.data.resultCode?(uni.showLoading({title:"正在下载",mask:!0}),uni.downloadFile({url:t.data.data.reportUrl,success:function(t){uni.hideLoading(),200===t.statusCode?uni.saveFile({tempFilePath:t.tempFilePath,success:function(e){e.savedFilePath;uni.showModal({title:"下载报告成功",content:"下载成功，是否直接打开",success:function(a){a.confirm?uni.openDocument({filePath:t.tempFilePath}):e.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:700")}})},fail:function(){uni.showModal({title:"提示",content:"下载报告失败，请重试",confirmText:"重试",success:function(t){t.confirm?e.downloadReport():t.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:714")}})}}):uni.showModal({title:"提示",content:"下载报告失败，请重试",confirmText:"重试",success:function(t){t.confirm?e.downloadReport():t.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:730")}})},fail:function(){uni.hideLoading(),uni.showModal({title:"提示",content:"下载报告失败，请重试",confirmText:"重试",success:function(t){t.confirm?e.downloadReport():t.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:746")}})}})):uni.showModal({title:"提示",content:"下载报告失败，请重试",confirmText:"重试",success:function(t){t.confirm?e.downloadReport():t.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:761")}})},fail:function(e){uni.showModal({title:"提示",content:"网络或服务器异常，请稍后再试",showCancel:!1,success:function(e){e.confirm?__f__("log","用户点击确定"," at pages\\transientDetails\\transientDetails.vue:774"):e.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:776")}})}})},previewPic:function(e){null!=e&&void 0!=e&&""!=e&&0!=e.length&&uni.previewImage({urls:[e],current:0,longPressActions:{itemList:["保存图片"],success:function(t){0==t.tapIndex&&(uni.showLoading({title:"图片保存中"}),uni.downloadFile({url:e,success:function(e){var t=e.tempFilePath;uni.saveImageToPhotosAlbum({filePath:t,success:function(){uni.showToast({icon:"success",title:"保存成功",duration:2e3})}})},complete:function(){uni.hideLoading()}}))},fail:function(e){uni.showModal({title:"保存失败",content:e.errMsg,showCancel:!1,success:function(e){e.confirm?__f__("log","用户点击确定"," at pages\\transientDetails\\transientDetails.vue:826"):e.cancel&&__f__("log","用户点击取消"," at pages\\transientDetails\\transientDetails.vue:828")}})}}})},retry:function(){this.eventDetailBaseInfo(),this.eventDetailEigenvalue(),this.eventDetailWave()}},onLoad:function(e){this.scrollH(),uni.showLoading({mask:!0}),this.eventDetailIndex=e.eventDetailIndex,this.eventMsgIndex=e.eventMsgIndex,this.eventDetailBaseInfo(),this.eventDetailEigenvalue(),this.eventDetailWave()},components:{back:back}};exports.default=_default}).call(this,__webpack_require__("6e42")["default"],__webpack_require__("0de9")["default"])},1504:function(e,t,a){"use strict";a.r(t);var n=a("06a4"),s=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);t["default"]=s.a},"60dd":function(e,t,a){},6610:function(e,t,a){"use strict";var n=a("60dd"),s=a.n(n);s.a},db65:function(e,t,a){"use strict";(function(e){a("986c"),a("921b");n(a("66fd"));var t=n(a("e8e6"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("6e42")["createPage"])},e8e6:function(e,t,a){"use strict";a.r(t);var n=a("f1ba"),s=a("1504");for(var i in s)"default"!==i&&function(e){a.d(t,e,function(){return s[e]})}(i);a("6610");var o,l=a("f0c5"),u=Object(l["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);t["default"]=u.exports},f1ba:function(e,t,a){"use strict";var n,s=function(){var e=this,t=e.$createElement;e._self._c},i=[];a.d(t,"b",function(){return s}),a.d(t,"c",function(){return i}),a.d(t,"a",function(){return n})}},[["db65","common/runtime","common/vendor"]]]);