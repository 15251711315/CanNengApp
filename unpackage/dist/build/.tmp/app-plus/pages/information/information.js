(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/information/information"],{"09dc":function(t,e,n){"use strict";n.r(e);var a=n("b78e"),i=n("a943");for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);n("3449");var r,u=n("f0c5"),l=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);e["default"]=l.exports},3449:function(t,e,n){"use strict";var a=n("feed"),i=n.n(a);i.a},a943:function(t,e,n){"use strict";n.r(e);var a=n("f3de"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);e["default"]=i.a},ac9f:function(t,e,n){"use strict";(function(t){n("986c"),n("921b");a(n("66fd"));var e=a(n("09dc"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},b78e:function(t,e,n){"use strict";var a,i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(t){})},s=[];n.d(e,"b",function(){return i}),n.d(e,"c",function(){return s}),n.d(e,"a",function(){return a})},f3de:function(module,exports,__webpack_require__){"use strict";(function(uni,__f__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default={data:function(){return{tabNum:1,terminalNum:0,terminalShowNum:0,steadyNum:0,steadyShowNum:0,transientNum:0,transientShowNum:0,transientPage:1,steadyPage:1,terminalPage:1,transientList:[],steadyList:[],terminalList:[],scrollHeight:"",eventMsgIndexList:[],steadyIndexList:[],devMsgIndexList:[],allNum:0,transientScrollTop:0,steadyScrollTop:0,terminalScrollTop:0,pullHeight:"",pullFlag:0,startY:0,pullText:"下拉刷新",transientRefreshFlag:0,steadyRefreshFlag:0,terminalRefreshFlag:0,current:0,scrollFlag:!0,noTransient:"",noSteady:"",noTerminal:""}},methods:{transientScrollMove:function(t){this.transientScrollTop=t.detail.scrollTop},transientTouchstart:function(t){this.startY=t.touches[0].clientY},transientTouchmove:function(t){var e=this;if(e.transientScrollTop<2){var n=t.changedTouches[0].clientY-e.startY;if(n>66||n<0)return;n<33?(e.pullText="下拉刷新",e.pullHeight=n+"px",e.pullFlag=1):(e.pullText="加载中...",e.pullHeight=n+"px",e.pullFlag=1,e.transientRefreshFlag=1,e.communicateState())}},transientTouchend:function(t){var e=this;e.scrollFlag=!1,setTimeout(function(){e.scrollFlag=!0},30),e.transientScrollTop=0,e.pullHeight="",e.startY=0,e.pullText="下拉刷新",e.pullFlag=0,1==e.transientRefreshFlag&&(e.transientRefreshFlag=0,e.transientList=[],e.noTransient="",e.transientNum=0,e.transientPage=1,e.queryTransientList())},steadyScrollMove:function(t){this.steadyScrollTop=t.detail.scrollTop},steadyTouchstart:function(t){this.startY=t.touches[0].clientY},steadyTouchmove:function(t){var e=this;if(e.steadyScrollTop<2){var n=t.changedTouches[0].clientY-e.startY;if(n>66||n<0)return;n<33?(e.pullText="下拉刷新",e.pullHeight=n+"px",e.pullFlag=1):(e.pullText="加载中...",e.pullHeight=n+"px",e.pullFlag=1,e.steadyRefreshFlag=1,e.communicateState())}},steadyTouchend:function(t){var e=this;e.scrollFlag=!1,setTimeout(function(){e.scrollFlag=!0},30),e.steadyScrollTop=0,e.pullHeight="",e.startY=0,e.pullText="下拉刷新",e.pullFlag=0,1==e.steadyRefreshFlag&&(e.steadyRefreshFlag=0,e.steadyList=[],e.noSteady="",e.steadyNum=0,e.steadyPage=1,e.querySteadyList())},terminalScrollMove:function(t){this.terminalScrollTop=t.detail.scrollTop},terminalTouchstart:function(t){this.startY=t.touches[0].clientY},terminalTouchmove:function(t){var e=this;if(e.terminalScrollTop<2){var n=t.changedTouches[0].clientY-e.startY;if(n>66||n<0)return;n<33?(e.pullText="下拉刷新",e.pullHeight=n+"px",e.pullFlag=1):(e.pullText="加载中...",e.pullHeight=n+"px",e.pullFlag=1,e.terminalRefreshFlag=1,e.communicateState())}},terminalTouchend:function(t){var e=this;e.scrollFlag=!1,setTimeout(function(){e.scrollFlag=!0},30),e.terminalScrollTop=0,e.pullHeight="",e.startY=0,e.pullText="下拉刷新",e.pullFlag=0,1==e.terminalRefreshFlag&&(e.terminalRefreshFlag=0,e.terminalList=[],e.noTerminal="",e.terminalNum=0,e.terminalPage=1,e.queryTerminalList())},scrollH:function(){var t=this,e=uni.getSystemInfoSync(),n=e.windowWidth,a=750/n,i=e.windowHeight,s=e.statusBarHeight;t.scrollHeight=parseInt((i-s)*a-152)+"rpx"},changeTab:function(t){var e=this;e.current=t-1,e.tabNum=t},changeTabBySwiper:function(t){this.tabNum=t.detail.current+1,this.current=t.detail.current},jumpToTransientDetails:function(t,e,n,a){var i=this;i.transientNum>0&&0==a&&(i.transientNum--,i.eventMsgIndexList.push(e),i.transientList[n].state=1),i.judgeTransientNum(),i.setAllNum(),i.communicateState(),uni.navigateTo({url:"../transientDetails/transientDetails?eventDetailIndex="+t+"&eventMsgIndex="+e})},jumpToSteady:function(t,e,n,a){var i=this;i.steadyNum>0&&0==a&&(i.steadyNum--,i.steadyIndexList.push(e),i.steadyList[n].state=1),i.judgeSteadyNum(),i.setAllNum(),i.communicateState(),uni.navigateTo({url:"../steady/steady?steadyIndex="+e+"&showTime="+t})},jumpToTerminal:function(t,e,n,a){var i=this;i.terminalNum>0&&0==a&&(i.terminalNum--,i.devMsgIndexList.push(e),i.terminalList[n].state=1),i.judgeTerminalNum(),i.setAllNum(),i.communicateState(),uni.navigateTo({url:"../terminal/terminal?devMsgIndex="+e+"&showTime="+t})},communicateState:function(){var t=this;uni.request({url:t.serverUrl+"/cleanmsg/clearMsg",method:"POST",data:{eventMsgList:t.eventMsgIndexList,steadyMsgList:t.steadyIndexList,deviceMsgList:t.devMsgIndexList},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function(t){"10000"==t.data.resultCode?__f__("log","同步成功"," at pages\\information\\information.vue:393"):__f__("log","同步失败"," at pages\\information\\information.vue:395")},fail:function(t){__f__("log","同步网络异常"," at pages\\information\\information.vue:399")}})},queryTransientList:function queryTransientList(){var that=this;that.judgeLogin()&&uni.request({url:that.serverUrl+"/eventmsg/eventDetailList",method:"POST",data:{userId:uni.getStorageSync("userInfo").userId,page:that.transientPage++,num:20},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function success(res){if(uni.hideLoading(),"10000"==res.data.resultCode){that.transientNum=res.data.unstate,that.judgeTransientNum();var list=[];list=that.countTransientNum(eval(res.data.data),1),2==that.transientPage&&(that.transientList=[]),null!=list&&void 0!=list&&""!=list&&list!=[]&&(that.transientList=that.transientList.concat(list)),0==that.transientList.length&&(that.noTransient="暂无暂态消息")}else uni.showModal({title:"提示",content:"查询失败，请重试",confirmText:"重试",success:function(t){t.confirm?(that.transientPage--,that.queryTransientList()):t.cancel&&__f__("log","用户点击取消"," at pages\\information\\information.vue:445")}})},fail:function(t){uni.hideLoading(),uni.showModal({title:"提示",content:"网络或服务器异常，请稍后再试",showCancel:!1,success:function(t){t.confirm?__f__("log","用户点击确定"," at pages\\information\\information.vue:459"):t.cancel&&__f__("log","用户点击取消"," at pages\\information\\information.vue:461")}})}})},countTransientNum:function(t,e){var n=this;if(1==e)for(var a=0;a<t.length;a++)t[a].showTime=n.formatTime_mills(t[a].timeID);else{var i=0;for(a=0;a<t.length;a++)0==t[a].state&&i++,n.transientNum=i}return n.setAllNum(),t},judgeTransientNum:function(){var t=this;t.transientNum>99?t.transientShowNum="99+":t.transientShowNum=t.transientNum},querySteadyList:function querySteadyList(){var that=this;that.judgeLogin()&&uni.request({url:that.serverUrl+"/steadymsg/steadyState",method:"POST",data:{userId:uni.getStorageSync("userInfo").userId,page:that.steadyPage++,num:20},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function success(res){if(uni.hideLoading(),"10000"==res.data.resultCode){that.steadyNum=res.data.unstate,that.judgeSteadyNum();var list=[];list=that.countSteadyNum(eval(res.data.data),1),2==that.steadyPage&&(that.steadyList=[]),null!=list&&void 0!=list&&""!=list&&list!=[]&&(that.steadyList=that.steadyList.concat(list)),0==that.steadyList.length&&(that.noSteady="暂无稳态越限消息")}else uni.showModal({title:"提示",content:"查询失败，请重试",confirmText:"重试",success:function(t){t.confirm?(that.steadyPage--,that.querySteadyList()):t.cancel&&__f__("log","用户点击取消"," at pages\\information\\information.vue:543")}})},fail:function(t){uni.hideLoading(),uni.showModal({title:"提示",content:"网络或服务器异常，请稍后再试",showCancel:!1,success:function(t){t.confirm?__f__("log","用户点击确定"," at pages\\information\\information.vue:557"):t.cancel&&__f__("log","用户点击取消"," at pages\\information\\information.vue:559")}})}})},countSteadyNum:function(t,e){var n=this;if(1==e)for(var a=0;a<t.length;a++)t[a].showTime=n.formatTime(t[a].timeID);else{var i=0;for(a=0;a<t.length;a++)0==t[a].state&&i++,n.steadyNum=i}return n.setAllNum(),t},judgeSteadyNum:function(){var t=this;t.steadyNum>99?t.steadyShowNum="99+":t.steadyShowNum=t.steadyNum},queryTerminalList:function queryTerminalList(){var that=this;that.judgeLogin()&&uni.request({url:that.serverUrl+"/deviceMsg/deviceMsgList",method:"POST",data:{userId:uni.getStorageSync("userInfo").userId,page:that.terminalPage++,num:20},header:{"content-type":"application/x-www-form-urlencoded"},sslVerify:!1,success:function success(res){if(uni.hideLoading(),"10000"==res.data.resultCode){that.terminalNum=res.data.unstate,that.judgeTerminalNum();var list=[];list=that.countTerminalNum(eval(res.data.data),1),2==that.terminalPage&&(that.terminalList=[]),null!=list&&void 0!=list&&""!=list&&list!=[]&&(that.terminalList=that.terminalList.concat(list)),0==that.terminalList.length&&(that.noTerminal="暂无终端越限消息")}else uni.showModal({title:"提示",content:"查询失败，请重试",confirmText:"重试",success:function(t){t.confirm?(that.terminalPage--,that.queryTerminalList()):t.cancel&&__f__("log","用户点击取消"," at pages\\information\\information.vue:641")}})},fail:function(t){uni.hideLoading(),uni.showModal({title:"提示",content:"网络或服务器异常，请稍后再试",showCancel:!1,success:function(t){t.confirm?__f__("log","用户点击确定"," at pages\\information\\information.vue:655"):t.cancel&&__f__("log","用户点击取消"," at pages\\information\\information.vue:657")}})}})},countTerminalNum:function(t,e){var n=this;if(1==e)for(var a=0;a<t.length;a++)t[a].showTime=n.formatTime(t[a].timeID);else{var i=0;for(a=0;a<t.length;a++)0==t[a].state&&i++,n.terminalNum=i}return n.setAllNum(),t},judgeTerminalNum:function(){var t=this;t.terminalNum>99?t.terminalShowNum="99+":t.terminalShowNum=t.terminalNum},setAllNum:function(){var t=this,e=parseInt(t.steadyNum)+parseInt(t.terminalNum)+parseInt(t.transientNum);uni.setStorageSync("allNum",e),e=e>99?"99+":""+e,0!=e?uni.setTabBarBadge({index:0,text:e}):uni.removeTabBarBadge({index:0})},refresh:function(){this.communicateState(),this.transientList=[],this.steadyList=[],this.terminalList=[],this.noTransient="",this.noSteady="",this.noTerminal="",this.steadyNum=0,this.terminalNum=0,this.transientNum=0,this.terminalPage=1,this.steadyPage=1,this.transientPage=1,this.$nextTick(function(){this.queryTransientList(),this.querySteadyList(),this.queryTerminalList()})}},onShow:function(){var t=this,e=uni.getStorageSync("tabNum");e&&(t.refresh(),t.tabNum=e,t.current=e-1,uni.removeStorageSync("tabNum"))},onLoad:function(t){var e=this;e.queryTransientList(),e.querySteadyList(),e.queryTerminalList(),e.scrollH(),uni.$on("tabNum",function(t){e.refresh(),e.tabNum=t,e.current=t-1})},onPullDownRefresh:function(){this.refresh(),setTimeout(function(){uni.stopPullDownRefresh()},2e3)}};exports.default=_default}).call(this,__webpack_require__("6e42")["default"],__webpack_require__("0de9")["default"])},feed:function(t,e,n){}},[["ac9f","common/runtime","common/vendor"]]]);